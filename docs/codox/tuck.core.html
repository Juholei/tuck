<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>tuck.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Tuck</span> <span class="project-version">20180721</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tuck</span></div></div></li><li class="depth-2 branch current"><a href="tuck.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="tuck.debug.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>debug</span></div></a></li><li class="depth-2 branch"><a href="tuck.intercept.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>intercept</span></div></a></li><li class="depth-2"><a href="tuck.path.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>path</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tuck.core.html#var-*allow-actions*"><div class="inner"><span>*allow-actions*</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-action.21"><div class="inner"><span>action!</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-current-send-function"><div class="inner"><span>current-send-function</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-define-assoc-events"><div class="inner"><span>define-assoc-events</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-define-event"><div class="inner"><span>define-event</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-Event"><div class="inner"><span>Event</span></div></a></li><li class="depth-2"><a href="tuck.core.html#var-process-event"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>process-event</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-send-async.21"><div class="inner"><span>send-async!</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-send-value.21"><div class="inner"><span>send-value!</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-tuck"><div class="inner"><span>tuck</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-UpdateAt"><div class="inner"><span>UpdateAt</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-wrap"><div class="inner"><span>wrap</span></div></a></li><li class="depth-1"><a href="tuck.core.html#var-wrap-path"><div class="inner"><span>wrap-path</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tuck.core</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-*allow-actions*"><h3>*allow-actions*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Bound to false when replaying events to disable side-effects.
</pre></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.cljs#L10">view source</a></div></div><div class="public anchor" id="var-action.21"><h3>action!</h3><div class="usage"><code>(action! action-fn &amp; args)</code></div><div class="doc"><pre class="plaintext">Run an action function that may side-effect and schedule asynchronous actions.
The first parameter of the action is the current send function. Actions only run
when *allow-actions* is true.</pre></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.cljs#L67">view source</a></div></div><div class="public anchor" id="var-current-send-function"><h3>current-send-function</h3><div class="usage"><code>(current-send-function)</code></div><div class="doc"><pre class="plaintext">Get the current send function. Must be called from within process-event.
</pre></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.cljs#L41">view source</a></div></div><div class="public anchor" id="var-define-assoc-events"><h3>define-assoc-events</h3><h4 class="type">macro</h4><div class="usage"><code>(define-assoc-events &amp; events-and-paths)</code></div><div class="doc"><div class="markdown"><p>Define events that simply take their parameter and assoc it to the given path in the app state. Takes pairs of event name and path-vector. For example:</p>
<p><code>(define-assoc-events UpdateUserName [:user :name])</code></p>
<p>Will define an event record type called UpdateUserName which has one field and whose <a href="tuck.core.html#var-process-event">process-event</a> will update the value of the field to the app state path <code>[:user :name]</code>. The new value will overwrite the value (if any) in the app state.</p></div></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.clj#L86">view source</a></div></div><div class="public anchor" id="var-define-event"><h3>define-event</h3><h4 class="type">macro</h4><div class="usage"><code>(define-event event-record-name event-params options &amp; body)</code></div><div class="doc"><div class="markdown"><p>Define a new event record type and its <a href="tuck.core.html#var-process-event">process-event</a> implementation.</p>
<ul>
  <li><code>event-record-name</code> must be a symbol defining the event name.</li>
  <li><code>event-params</code> is a vector containing the names of the record’s fields.</li>
  <li><code>options</code> a map of parameters.</li>
  <li><code>body</code> code to apply the event to current app state.</li>
</ul>
<p>Supported options:</p>
<ul>
  <li><code>:path</code> a vector containing a path to the app state where the update should take place</li>
  <li><code>:app</code> a name to bind the current app state to (defaults to <code>app</code>)</li>
</ul>
<p>The code in <code>body</code> can refer to the event params and the app state by their name. The app state is the value under <code>:path</code> and the returned value will replace it.</p>
<p>Example:</p>
<pre><code class="clojure">(define-event UpdateCustomerForm [form-data]
  {:path [:customer :editing]
   :app customer}
  (merge customer form-data))
</code></pre></div></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.clj#L30">view source</a></div></div><div class="public anchor" id="var-Event"><h3>Event</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-process-event"><h3>process-event</h3><div class="usage"><code>(process-event this app-state)</code></div><div class="doc"><pre class="plaintext">Process this event for the current app state. Must return new state.
</pre></div></div></div></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.cljs#L14">view source</a></div></div><div class="public anchor" id="var-send-async.21"><h3>send-async!</h3><div class="usage"><code>(send-async! constructor &amp; args)</code></div><div class="doc"><div class="markdown"><p>Returns a callback function which will create and apply a new event. THe <code>constructor</code> must be a function that returns an event. The constructor is called with the callback parameters and the (optional) arguments.</p>
<p><strong>Must be called from within <a href="tuck.core.html#var-process-event">process-event</a>.</strong></p>
<p>Example:</p>
<pre><code class="clojure">;; inside some event's processing code
(GET! "/fetch-things" {:on-success (t/send-async! -&gt;FetchThingsResponse)
                       :on-failure (t/send-async! -&gt;ServerError)})
</code></pre></div></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.cljs#L47">view source</a></div></div><div class="public anchor" id="var-send-value.21"><h3>send-value!</h3><div class="usage"><code>(send-value! e! constructor &amp; args)</code></div><div class="doc"><div class="markdown"><p>Returns a UI event handler that sends the event’s value to the UI message processing after calling constructor with it. Useful for DOM change effects.</p>
<p>Example:</p>
<pre><code class="clojure">[:input {:type "text"
         :value name
         :on-change (t/send-value! e! -&gt;UpdateName)}]
</code></pre></div></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.cljs#L24">view source</a></div></div><div class="public anchor" id="var-tuck"><h3>tuck</h3><div class="usage"><code>(tuck app root-component)</code><code>(tuck app root-component options)</code></div><div class="doc"><pre class="plaintext">Entrypoint for tuck. Takes in a reagent atom and a root component.
The root component will be rendered with two parameters: a ui control
function (for sending events to) and the current state of the app atom.

The optional options map can have the following keys:
:path-fn   If path-fn is provided, it is called to return a path (for update-in)
           for the event. If the path-fn returns nil for the event, the event is
           applied to the app root. Path-fn is an alternative to wrapping send
           functions for routing events to different parts of the state atom.
:spec      If specified, the app state is validate against the spec after each
           event. If the new state is invalid the on-invalid-state handler is
           called to fix it.

:on-invalid-state
           Handler to call when the app state after an event fails spec validation.
           Must return new (fixed) app state. Takes 4 arguments: the previous state,
           the event that caused the invalid state, the new invalid state and the
           spec it was validated against.
           Default implementation logs the event and clojure.spec explain output
           and returns the previous valid state.

For backwards compatibility, if options is a function, it is interpreted to mean
the path-fn.

The options are evaluated once, when the component is created and changes to
options don't take effect during the component's lifetime.</pre></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.cljs#L132">view source</a></div></div><div class="public anchor" id="var-UpdateAt"><h3>UpdateAt</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.cljs#L18">view source</a></div></div><div class="public anchor" id="var-wrap"><h3>wrap</h3><div class="usage"><code>(wrap e! wrap-constructor &amp; args)</code></div><div class="doc"><pre class="plaintext">Wrap the given UI send function with the given constructor
and optional arguments. Returns a new UI send function where
each event is mapped with the constructor before being sent.</pre></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.cljs#L78">view source</a></div></div><div class="public anchor" id="var-wrap-path"><h3>wrap-path</h3><div class="usage"><code>(wrap-path e! &amp; key-path)</code></div><div class="doc"><pre class="plaintext">Wrap the given UI send function with an UpdateAt event for
the given key-path.</pre></div><div class="src-link"><a href="https://github.com/tatut/tuck/blob/master/src/tuck/core.cljs#L88">view source</a></div></div></div></body></html>